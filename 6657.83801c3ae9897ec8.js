"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6657],{6657:(J,m,l)=>{l.r(m),l.d(m,{ViewEntriesPageModule:()=>U});var c=l(177),p=l(4341),s=l(3819),u=l(9858),f=l(8581),d=l(4618),e=l(4438),h=l(7225),_=l(2038),E=l(4988),C=l(529),P=l(9385);let y=(()=>{var n;class r{transform(o,a=0,i="down"){return("down"===i?Math.floor:Math.ceil)(o*10**a)/10**a}}return(n=r).\u0275fac=function(o){return new(o||n)},n.\u0275pipe=e.EJ8({name:"toFixed",type:n,pure:!0}),r})();function v(n,r){if(1&n){const t=e.RV6();e.j41(0,"ion-button",6),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.incrementPage(-1))}),e.nrm(1,"ion-icon",7),e.k0s()}}function F(n,r){if(1&n){const t=e.RV6();e.j41(0,"ion-button",6),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.incrementPage(1))}),e.nrm(1,"ion-icon",8),e.k0s()}}function w(n,r){if(1&n&&(e.j41(0,"ion-toolbar")(1,"ion-row",1)(2,"ion-col",2),e.DNE(3,v,2,0,"ion-button",3),e.k0s(),e.j41(4,"ion-col",4)(5,"p"),e.EFF(6),e.nI1(7,"toFixed"),e.k0s()(),e.j41(8,"ion-col",5),e.DNE(9,F,2,0,"ion-button",3),e.k0s()()()),2&n){let t;const o=e.XpG();e.R7$(3),e.Y8G("ngIf",o.pageable.page-1>0),e.R7$(3),e.Lme("page ",o.pageable.page," of ",e.brH(7,4,o.pageable.totalElements?o.pageable.totalElements/o.pageable.size:o.pageable.page,0,"up"),""),e.R7$(3),e.Y8G("ngIf",(null!==(t=o.pageable.totalElements)&&void 0!==t?t:o.pageable.size)>o.pageable.page*o.pageable.size)}}let T=(()=>{var n;class r{constructor(){this.pageableChange=new e.bkB,this.onPageChanged=new e.bkB}ngOnInit(){}incrementPage(o){this.pageable.page+=o,this.pageableChange.emit(this.pageable),this.onPageChanged.emit(this.pageable)}}return(n=r).\u0275fac=function(o){return new(o||n)},n.\u0275cmp=e.VBU({type:n,selectors:[["app-paging"]],inputs:{pageable:"pageable"},outputs:{pageableChange:"pageableChange",onPageChanged:"onPageChanged"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"flex","justify-content-between"],[1,"flex","justify-content-start"],["fill","clear",3,"click",4,"ngIf"],[1,"flex","justify-content-center"],[1,"flex","justify-content-end"],["fill","clear",3,"click"],["color","medium","slot","icon-only","name","chevron-back"],["color","medium","slot","icon-only","name","chevron-forward"]],template:function(o,a){1&o&&e.DNE(0,w,10,8,"ion-toolbar",0),2&o&&e.Y8G("ngIf",a.pageable)},dependencies:[c.bT,s.Jm,s.hU,s.iq,s.ln,s.ai,y]}),r})(),j=(()=>{var n;class r{transform(o,a){return 0===a?0:o/a}}return(n=r).\u0275fac=function(o){return new(o||n)},n.\u0275pipe=e.EJ8({name:"fractionOf",type:n,pure:!0}),r})(),I=(()=>{var n;class r{transform(o,a){return 0===a?0:Math.round(o/a*100)}}return(n=r).\u0275fac=function(o){return new(o||n)},n.\u0275pipe=e.EJ8({name:"percentOf",type:n,pure:!0}),r})();const S=n=>({above:n});function k(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",1),e.bIt("click",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.changeMode())}),e.j41(1,"span",2)(2,"small"),e.EFF(3),e.k0s()(),e.nrm(4,"ion-progress-bar",3),e.nI1(5,"fractionOf"),e.nI1(6,"fractionOf"),e.j41(7,"div",4)(8,"p",5),e.EFF(9),e.k0s(),e.j41(10,"p",6),e.EFF(11),e.nI1(12,"percentOf"),e.k0s(),e.j41(13,"p",7),e.EFF(14),e.k0s()()()}if(2&n){const t=e.XpG();e.Y8G("ngClass",e.eq3(17,S,t.total>t.target)),e.R7$(3),e.JRh(t.title),e.R7$(),e.Y8G("value",t.total>t.target?e.i5U(5,8,t.target,t.total):e.i5U(6,11,t.total,t.target)),e.R7$(5),e.Lme("",t.total>t.target?"goal":"total "," ",t.total>t.target?t.target:t.total,"g"),e.R7$(2),e.JRh(t.total>t.target?t.total-t.target+"g exceeded":e.i5U(12,14,t.total,t.target)+"%"),e.R7$(3),e.Lme("",t.total>t.target?"total":"goal "," ",t.total>t.target?t.total:t.target,"g")}}let R=(()=>{var n;class r{constructor(o,a){this.foodLogService=o,this.loadingService=a,this.total=0,this.onTotalChange=new e.bkB}ngOnInit(){this.setup()}setup(){}getCarbGoal(){this.loadingService.addToQueue(this.foodLogService.getDailyCarbGoal().then(o=>{}))}changeMode(){}}return(n=r).\u0275fac=function(o){return new(o||n)(e.rXU(h.i),e.rXU(_.U))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-progress-display"]],inputs:{total:"total",target:"target",title:"title"},outputs:{onTotalChange:"onTotalChange"},decls:1,vars:1,consts:[["class","mx-2 carb-goal-progress",3,"ngClass","click",4,"ngIf"],[1,"mx-2","carb-goal-progress",3,"click","ngClass"],[1,"flex","justify-content-center"],[3,"value"],[1,"flex","justify-content-between","above"],[1,"my-1","carb-progress-value-text"],[1,"my-1"],[1,"my-1","carb-progress-target-text"]],template:function(o,a){1&o&&e.DNE(0,k,15,19,"div",0),2&o&&e.Y8G("ngIf",a.target)},dependencies:[c.YU,c.bT,s.FH,j,I]}),r})();var V=l(7058);const b=()=>({weekday:"short",month:"long",day:"2-digit"}),D=n=>({date:n});function O(n,r){if(1&n){const t=e.RV6();e.j41(0,"ion-datetime",18),e.mxI("ngModelChange",function(a){e.eBV(t);const i=e.XpG();return e.DH7(i.fromDateString,a)||(i.fromDateString=a),e.Njj(a)}),e.bIt("ionChange",function(a){e.eBV(t);const i=e.XpG();return e.Njj(i.fromDateChanged(a))}),e.j41(1,"span",19),e.EFF(2,"Select from date"),e.k0s()()}if(2&n){const t=e.XpG();e.R50("ngModel",t.fromDateString),e.Y8G("formatOptions",e.eq3(4,D,e.lJ4(3,b)))("showDefaultButtons",!0)}}function G(n,r){if(1&n){const t=e.RV6();e.j41(0,"ion-datetime",20),e.mxI("ngModelChange",function(a){e.eBV(t);const i=e.XpG();return e.DH7(i.toDateString,a)||(i.toDateString=a),e.Njj(a)}),e.bIt("ionChange",function(a){e.eBV(t);const i=e.XpG();return e.Njj(i.toDateChanged(a))}),e.j41(1,"span",19),e.EFF(2,"Select from date"),e.k0s()()}if(2&n){const t=e.XpG();e.R50("ngModel",t.toDateString),e.Y8G("formatOptions",e.eq3(4,D,e.lJ4(3,b)))("showDefaultButtons",!0)}}function x(n,r){if(1&n&&(e.j41(0,"ion-row")(1,"ion-card-subtitle")(2,"strong"),e.EFF(3),e.k0s()()()),2&n){const t=e.XpG().$implicit;e.R7$(3),e.JRh(t.note)}}function M(n,r){if(1&n&&(e.j41(0,"ion-card",32)(1,"ion-card-content",33),e.nrm(2,"app-portion",34),e.k0s()()),2&n){const t=r.$implicit;e.R7$(2),e.Y8G("portionId",t)("allowDBDeletion",!1)("allowEdit",!1)}}function L(n,r){if(1&n){const t=e.RV6();e.j41(0,"ion-card",21)(1,"ion-card-header",22),e.DNE(2,x,4,1,"ion-row",23),e.j41(3,"ion-row")(4,"ion-card-subtitle"),e.EFF(5),e.nI1(6,"ordinalDate"),e.k0s()(),e.j41(7,"ion-row")(8,"ion-card-title"),e.EFF(9),e.k0s()()(),e.j41(10,"ion-card-content")(11,"ion-row")(12,"h1"),e.EFF(13),e.k0s()(),e.j41(14,"ion-row")(15,"ion-accordion-group",24)(16,"ion-accordion",25)(17,"ion-item",26)(18,"ion-card-subtitle"),e.EFF(19),e.k0s()(),e.j41(20,"div",27),e.DNE(21,M,3,3,"ion-card",28),e.k0s()()()(),e.j41(22,"ion-row")(23,"ion-col",4)(24,"div",29)(25,"ion-button",30),e.bIt("click",function(){const a=e.eBV(t).$implicit,i=e.XpG();return e.Njj(i.deleteEntry(a))}),e.nrm(26,"ion-icon",31),e.k0s()()()()()()}if(2&n){const t=r.$implicit;e.R7$(2),e.Y8G("ngIf",t.note),e.R7$(3),e.JRh(e.bMT(6,7,t.date)),e.R7$(4),e.JRh(t.name),e.R7$(4),e.SpI("Carbs: ",t.carbs,"g"),e.R7$(6),e.Lme("",t.portionIds.length," portion",t.portionIds.length>1?"s":"",""),e.R7$(2),e.Y8G("ngForOf",t.portionIds)}}const B=[{path:"",component:(()=>{var n;class r{constructor(o,a,i,g){this.foodLogService=o,this.loadingService=a,this.alertService=i,this.messageService=g,this.pageable={page:1,size:5},this.today=new Date,this.fromDate=new Date,this.toDate=new Date,this.progress={carbGoal:0,carbTotal:0,title:""}}ngOnInit(){this.setupDateRange(),this.setup()}setup(){this.loadFoodLogs()}setupDateRange(){this.today=new Date,this.fromDate=d.E.getStartOfDay(this.today),this.toDate=d.E.getEndOfDay(this.today)}loadFoodLogs(){this.calculateCarbValues(),this.loadingService.addToQueue(this.foodLogService.getAllInRangeOrderedByIndexPaged(f.$I.FOOD_LOG_TBL_DATE,this.pageable,"desc",this.fromDate,this.toDate).then(o=>{this.foodLogs=o}))}calculateCarbValues(){let o=this.toDate.getTime()-this.fromDate.getTime(),a=Math.round(o/864e5);this.loadingService.addToQueue(this.foodLogService.getDailyCarbGoal().then(i=>{this.progress.carbGoal=i*a,this.progress.title=`${a} day${1==a?"":"s"}`})),this.loadingService.addToQueue(this.foodLogService.getAllInRangeOrderedByIndexPaged(f.$I.FOOD_LOG_TBL_DATE,{page:0,size:999999999},"desc",this.fromDate,this.toDate).then(i=>{i||(this.progress.carbTotal=0),this.progress.carbTotal=i.reduce((g,X)=>g+(X.carbs||0),0)}))}pageChanged(o){this.loadFoodLogs()}deleteEntry(o){this.alertService.promptConfirmation("Confirm","are you sure you want to delete this entry?","no","yes").then(a=>{a&&this.loadingService.addToQueue(this.foodLogService.deleteEntityFromDB(o.id).then(()=>{this.pageChanged(this.pageable)}))})}fromDateChanged(o){let i=new Date(o.detail.value);if(i.getTime()>this.toDate.getTime())return this.alertService.simpleError("From date must be before to date."),void(this.fromDateString=this.toLocalISOString(this.fromDate));this.fromDate=i,this.fromDate=d.E.getStartOfDay(this.fromDate),this.loadFoodLogs()}toDateChanged(o){let i=new Date(o.detail.value);if(i.getTime()<this.fromDate.getTime())return this.alertService.simpleError("To date must be after from date."),void(this.toDateString=this.toLocalISOString(this.toDate));this.toDate=i,this.toDate=d.E.getEndOfDay(this.toDate),this.loadFoodLogs()}incrementRange(o){let a=this.toDate.getTime()-this.fromDate.getTime(),i=Math.round(a/864e5);this.fromDate=this.addDays(this.fromDate,i*o),this.toDate=this.addDays(this.toDate,i*o),this.fromDateString=this.toLocalISOString(this.fromDate),this.toDateString=this.toLocalISOString(this.toDate),this.loadFoodLogs()}addDays(o,a){const i=new Date(o);return i.setDate(i.getDate()+a),i}toLocalISOString(o){const a=6e4*o.getTimezoneOffset();return new Date(o.getTime()-a).toISOString().slice(0,-1)}}return(n=r).\u0275fac=function(o){return new(o||n)(e.rXU(h.i),e.rXU(_.U),e.rXU(E.u),e.rXU(C.b))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-view-entries"]],decls:33,vars:9,consts:[[3,"translucent"],["slot","start"],["size","large"],[1,"flex","justify-content-between"],[1,"flex","justify-content-start"],["fill","clear",3,"click"],["color","medium","slot","icon-only","name","chevron-back"],[1,"flex","flex-row","justify-content-center"],[1,"date-picker"],["datetime","from-datetime"],["datetime","to-datetime"],[1,"flex","justify-content-end"],["color","medium","slot","icon-only","name","chevron-forward"],[3,"keepContentsMounted"],[3,"fullscreen"],["class","no-padding-card",4,"ngFor","ngForOf"],[3,"total","target","title"],[3,"pageableChange","onPageChanged","pageable"],["id","from-datetime","presentation","date",3,"ngModelChange","ionChange","ngModel","formatOptions","showDefaultButtons"],["slot","title"],["id","to-datetime","presentation","date",3,"ngModelChange","ionChange","ngModel","formatOptions","showDefaultButtons"],[1,"no-padding-card"],["mode","ios"],[4,"ngIf"],[1,"w-full"],["value","first"],["slot","header"],["slot","content"],["class","portion-card",4,"ngFor","ngForOf"],[1,"flex","align-items-start"],["item-start","","fill","clear","color","danger",3,"click"],["slot","icon-only","name","trash"],[1,"portion-card"],[1,"no-padding"],[3,"portionId","allowDBDeletion","allowEdit"]],template:function(o,a){1&o&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e.nrm(3,"ion-menu-button"),e.k0s(),e.j41(4,"ion-title",2),e.EFF(5,"Entries"),e.k0s()(),e.j41(6,"ion-toolbar")(7,"ion-row",3)(8,"ion-col",4)(9,"ion-button",5),e.bIt("click",function(){return a.incrementRange(-1)}),e.nrm(10,"ion-icon",6),e.k0s()(),e.j41(11,"div",7)(12,"div",8)(13,"ion-label"),e.EFF(14,"From Date"),e.k0s(),e.nrm(15,"ion-datetime-button",9),e.k0s(),e.j41(16,"div",8)(17,"ion-label"),e.EFF(18,"To Date"),e.k0s(),e.nrm(19,"ion-datetime-button",10),e.k0s()(),e.j41(20,"ion-col",11)(21,"ion-button",5),e.bIt("click",function(){return a.incrementRange(1)}),e.nrm(22,"ion-icon",12),e.k0s()()()()(),e.j41(23,"ion-modal",13),e.DNE(24,O,3,6,"ng-template"),e.k0s(),e.j41(25,"ion-modal",13),e.DNE(26,G,3,6,"ng-template"),e.k0s(),e.j41(27,"ion-content",14),e.DNE(28,L,27,9,"ion-card",15),e.k0s(),e.j41(29,"ion-footer")(30,"ion-toolbar"),e.nrm(31,"app-progress-display",16),e.j41(32,"app-paging",17),e.mxI("pageableChange",function(g){return e.DH7(a.pageable,g)||(a.pageable=g),g}),e.bIt("onPageChanged",function(g){return a.pageChanged(g)}),e.k0s()()()),2&o&&(e.Y8G("translucent",!0),e.R7$(23),e.Y8G("keepContentsMounted",!0),e.R7$(2),e.Y8G("keepContentsMounted",!0),e.R7$(2),e.Y8G("fullscreen",!0),e.R7$(),e.Y8G("ngForOf",a.foodLogs),e.R7$(3),e.Y8G("total",a.progress.carbTotal)("target",a.progress.carbGoal)("title",a.progress.title),e.R7$(),e.R50("pageable",a.pageable))},dependencies:[c.Sq,c.bT,p.BC,p.vS,s.xk,s.YH,s.Jm,s.QW,s.b_,s.I9,s.ME,s.HW,s.tN,s.hU,s.W9,s.A9,s.K4,s.M0,s.eU,s.iq,s.uz,s.he,s.MC,s.ln,s.BC,s.ai,s.Sb,s.Je,P.x,T,R,V.W]}),r})()}];let $=(()=>{var n;class r{}return(n=r).\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[u.iI.forChild(B),u.iI]}),r})();var Y=l(1815),N=l(4683);let U=(()=>{var n;class r{}return(n=r).\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[c.MD,p.YN,s.bv,$,Y.U,N.Y]}),r})()}}]);