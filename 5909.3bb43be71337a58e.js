"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5909],{9195:(E,f,s)=>{s.d(f,{g:()=>e});let e=(()=>{var h;class _{}return(h=_).catalogItems=[{id:1,name:"Chips",image:"https://static.toiimg.com/thumb/54659021.cms?imgsize=275086&width=800&height=800"},{id:2,name:"Tortilla",image:"https://images.immediate.co.uk/production/volatile/sites/30/2023/06/Next-level-Spanish-tortilla-1a79751.jpg?quality=90&resize=556,505",isFavourite:!0,colour:"#afafaf"},{id:3,name:"Beans",image:"https://static01.nyt.com/images/2014/04/16/dining/16JPEASTER2/16JPEASTER2-superJumbo.jpg"},{id:4,name:"Potato",image:"https://www.allrecipes.com/thmb/qcZxB4VshYreKE0aOnocvXUlfUs=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc()/24332-ultimate-twice-baked-potato-DDMFS-4x3-1643-94592bde74914b7498d59c19c2d5e5ab.jpg"},{id:5,name:"Ham",image:"https://urbanmerchants.co.uk/wp-content/uploads/2022/11/honey-roasted-ham-slices-main-500px.jpg"},{id:6,name:"Apple",image:"https://cdn.britannica.com/22/187222-050-07B17FB6/apples-on-a-tree-branch.jpg",isFavourite:!0},{id:7,name:"Orange",image:"https://images.immediate.co.uk/production/volatile/sites/30/2017/06/oranges-85fb2b6.jpg?quality=90&resize=556,505",colour:"#48afdf"},{id:8,name:"Bacon",image:"https://assets.epicurious.com/photos/630386df4eaa77f49a537aa5/1:1/w_2560%2Cc_limit/Brown_Sugar_Bacon_RECIPE_081722_38635.jpg"},{id:9,name:"Burger",image:"https://assets.tmecosys.com/image/upload/t_web767x639/img/recipe/ras/Assets/102cf51c-9220-4278-8b63-2b9611ad275e/Derivates/3831dbe2-352e-4409-a2e2-fc87d11cab0a.jpg",isFavourite:!0},{id:10,name:"Chocolate things",isFolder:!0,colour:"rgb(5, 255, 26)",childIds:[2,3,4,5,6]},{id:11,name:"Jamon iberico"},{id:12,name:"Strawberry",colour:"#48afdf"},{id:13,name:"Frozen",image:"https://lh6.googleusercontent.com/proxy/iDA98JUgES3jkSOSH5NY7wKOhAQMkv8hjEo43BAoGWN_ihjxEUZ3V_JrOUFOag9ZN0UrF7TC1xxoY3odCpDLMhux7s-Z8cJCVMecAlxWng",isFolder:!0,isFavourite:!0,colour:"#48afdf",childIds:[7,8,9,10,6,5]},{id:14,name:"Toast"},{id:15,name:"Nuttella toast"},{id:16,name:"Jelly babies",image:"https://oldestsweetshop.co.uk/cdn/shop/products/jelly_babies_1_648x.jpg?v=1600869372"},{id:17,name:"Doritos"},{id:18,name:"Jam",image:"https://media-cdn2.greatbritishchefs.com/media/xhfjzhwv/img74897.whqc_768x512q80.jpg"},{id:19,name:"Eat the bird meal",isGroup:!0,image:"https://media-cdn2.greatbritishchefs.com/media/xhfjzhwv/img74897.whqc_768x512q80.jpg",colour:"#df4882"}],h.portions=[{id:1,name:"small",catalogItemId:1,carbs:100},{id:2,name:"medium",catalogItemId:1,carbs:200},{id:3,name:"large",catalogItemId:1,carbs:300}],_})()},8385:(E,f,s)=>{s.d(f,{g:()=>p});var e=s(4438),h=s(3819);function _(c,m){if(1&c&&(e.j41(0,"p")(1,"b"),e.EFF(2),e.k0s()()),2&c){const u=e.XpG();e.R7$(2),e.SpI("",u.selectedItems.length," items selected")}}function D(c,m){if(1&c&&(e.j41(0,"p")(1,"b"),e.EFF(2),e.k0s()()),2&c){const u=e.XpG();e.R7$(2),e.SpI("",u.selectedPortions.length," portions selected")}}let p=(()=>{var c;class m{constructor(d){this.modalController=d,this.title="Catalog",this.canAddItems=!1,this.canSelectItems=!1,this.canSelectPortions=!1,this.returnData={},this.selectedItems=[],this.selectedPortions=[]}ngOnInit(){}dismiss(){return this.modalController.dismiss(this.constructReturnData("dismiss"))}confirm(){return this.modalController.dismiss(this.constructReturnData("confirmSelection"))}itemSelected(d){-1==this.selectedItems.indexOf(d)&&this.selectedItems.push(d)}portionSelected(d){-1==this.selectedPortions.indexOf(d)&&this.selectedPortions.push(d)}constructReturnData(d){let t={...this.returnData};return t.returnedItems=this.selectedItems,t.returnedPortions=this.selectedPortions,t}}return(c=m).\u0275fac=function(d){return new(d||c)(e.rXU(h.W3))},c.\u0275cmp=e.VBU({type:c,selectors:[["app-food-catalog-modal"]],decls:23,vars:9,consts:[["catalog",""],["slot","end"],["color","medium",3,"click"],["name","close"],[3,"translucent"],["headerMode","none",3,"segmentChanged"],[3,"fullscreen"],[3,"onItemSelected","onPortionSelected","canAddItems","canSelectPortions","canSelectItems"],[3,"searchTermChanged"],[4,"ngIf"],[3,"click","strong"]],template:function(d,t){if(1&d){const a=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3),e.k0s(),e.j41(4,"ion-buttons",1)(5,"ion-button",2),e.bIt("click",function(){return e.eBV(a),e.Njj(t.dismiss())}),e.nrm(6,"ion-icon",3),e.k0s()()()(),e.j41(7,"ion-header",4)(8,"app-food-catalog-header",5),e.bIt("segmentChanged",function(n){e.eBV(a);const o=e.sdS(11);return e.Njj(o.handleSegmentChanged(n))}),e.k0s()(),e.j41(9,"ion-content",6)(10,"app-food-catalog",7,0),e.bIt("onItemSelected",function(n){return e.eBV(a),e.Njj(t.itemSelected(n))})("onPortionSelected",function(n){return e.eBV(a),e.Njj(t.portionSelected(n))}),e.k0s()(),e.j41(12,"ion-footer")(13,"app-food-catalog-footer",8),e.bIt("searchTermChanged",function(n){e.eBV(a);const o=e.sdS(11);return e.Njj(o.handleSearchTermChanged(n))}),e.k0s()(),e.j41(14,"ion-footer")(15,"ion-toolbar"),e.DNE(16,_,3,1,"p",9)(17,D,3,1,"p",9),e.j41(18,"ion-buttons",1)(19,"ion-button",2),e.bIt("click",function(){return e.eBV(a),e.Njj(t.dismiss())}),e.EFF(20," Cancel "),e.k0s(),e.j41(21,"ion-button",10),e.bIt("click",function(){return e.eBV(a),e.Njj(t.confirm())}),e.EFF(22,"Confirm"),e.k0s()()()()}2&d&&(e.R7$(3),e.JRh(t.title),e.R7$(4),e.Y8G("translucent",!0),e.R7$(2),e.Y8G("fullscreen",!0),e.R7$(),e.Y8G("canAddItems",t.canAddItems)("canSelectPortions",t.canSelectPortions)("canSelectItems",t.canSelectItems),e.R7$(6),e.Y8G("ngIf",t.canSelectItems),e.R7$(),e.Y8G("ngIf",t.canSelectPortions),e.R7$(4),e.Y8G("strong",!0))}}),m})()},9275:(E,f,s)=>{s.d(f,{y:()=>c});var e=s(467),h=s(4412),_=s(4438),D=s(8581),p=s(2038);let c=(()=>{var m;class u{constructor(t,a){this.databaseService=t,this.loadingService=a,this.dataReady=new h.t(!1),this.subscriptions=[],this.setupTableData(),this.setupDefaultData(),this.subscribeToEvents()}restoreDefaultData(){return new Promise(t=>{this.deleteDefaultData().then(()=>(this.setupDefaultData(!0),t()))})}subscribeToEvents(){this.subscriptions.push(this.databaseService.$deleteDefaultData.subscribe(t=>{t&&this.loadingService.addToQueue(this.deleteDefaultData())})),this.subscriptions.push(this.databaseService.$restoreDefaultData.subscribe(t=>{t&&this.loadingService.addToQueue(this.restoreDefaultData())}))}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}getAll(t){let a=this.getValidateTableName(t);return new Promise((r,n)=>{this.databaseService.getDatabase().then(o=>o.getAll(a)).then(o=>{r(o)})})}getAllForIndex(t,a,r){let n=this.getValidateTableName(r);return new Promise((o,l)=>{this.databaseService.getDatabase().then(i=>i.getAllFromIndex(n,t,a)).then(i=>o(i))})}getAllOrderedByIndex(t,a="asc",r){let n=this.getValidateTableName(r);return new Promise((o,l)=>{this.databaseService.getDatabase().then(i=>i.getAllFromIndex(n,t)).then(i=>(i="desc"===a?i.reverse():i,o(i)))})}getAllOrderedByIndexPaged(t,a,r="asc",n){let o=this.getValidateTableName(n);return new Promise(l=>{this.databaseService.getDatabase().then(function(){var i=(0,e.A)(function*(g){const I=g.transaction(o,"readonly").objectStore(o).index(t),S=[],j="asc"===r?I.openCursor():I.openCursor(null,"prev");a.totalElements=yield I.count();let P=0,O=0;const y=(a.page-1)*a.size;let M=!1;for(;!M;)yield j.then(function(){var A=(0,e.A)(function*(v){var T;v&&O<a.size&&P<(null!==(T=a.totalElements)&&void 0!==T?T:-1)?(P>=y&&(S.push(v.value),O++),P++,null!=v.request&&(yield v.continue())):M=!0});return function(v){return A.apply(this,arguments)}}());return l(S)});return function(g){return i.apply(this,arguments)}}()).then(i=>l(i))})}getByKey(t,a){let r=this.getValidateTableName(a);return new Promise((n,o)=>{this.databaseService.getDatabase().then(l=>l.get(r,t)).then(l=>n(l))})}getPropertyByKey(t,a){return new Promise(r=>{this.getByKey(t).then(n=>{var o;return r(null!==(o=null==n?void 0:n[a])&&void 0!==o?o:void 0)})})}saveItemToDB(t,a="id"){let r,n=this.getValidateTableName();return new Promise(o=>{this.databaseService.getDatabase().then(l=>(r=l,t[a]?this.updateEntityInDB(r,t):this.createEntityInDB(r,t))).then(l=>r.get(n,l)).then(l=>(l||console.error("Tried to get saved item but not found"),o(l)))})}updateEntityInDB(t,a){let r=this.getValidateTableName();return t.put(r,a)}createEntityInDB(t,a){let r=this.getValidateTableName();return t.add(r,a)}deleteEntityFromDB(t){if(null==t)throw console.log("Error - tried to delete item with no id"),"Error - tried to delete item with no id";let a,r=this.getValidateTableName();return new Promise(n=>{this.databaseService.getDatabase().then(o=>(a=o,a.delete(r,t))).then(()=>{n()})})}getValidateTableName(t){let a=null!=t?t:this.tableName;return null==a&&console.error("Class extending AbstractDataService has not set tablename","this must be setup in the service constructor"),null!=a?a:"no valid name supplied"}}return(m=u).\u0275fac=function(t){return new(t||m)(_.KVO(D.BP),_.KVO(p.U))},m.\u0275prov=_.jDH({token:m,factory:m.\u0275fac,providedIn:"root"}),u})()},4569:(E,f,s)=>{s.d(f,{H:()=>d});var e=s(467),h=s(8581),_=s(9195),D=s(9275),p=s(8385),c=s(4438),m=s(3819),u=s(2038);let d=(()=>{var t;class a extends D.y{constructor(n,o,l){super(o,l),this.modalController=n,this.databaseService=o,this.loadingService=l}deleteDefaultData(){var n=this;let o=_.g.catalogItems;return new Promise(l=>{let i=0;o.forEach(function(){var g=(0,e.A)(function*(b){if(yield n.deleteEntityFromDB(b.id),i++,i>=o.length)return l()});return function(b){return g.apply(this,arguments)}}())})}setupTableData(){this.tableName=h.jj.CATALOG_ITEM}setupDefaultData(n){var o=this;return(0,e.A)(function*(){let l;o.databaseService.getDatabase().then(i=>(l=i,l.count(h.jj.CATALOG_ITEM))).then(i=>{i<=0||n?_.g.catalogItems.forEach(function(){var g=(0,e.A)(function*(b){yield o.createEntityInDB(l,b),_.g.catalogItems.indexOf(b)>=_.g.catalogItems.length-1&&o.dataReady.next(!0)});return function(b){return g.apply(this,arguments)}}()):o.dataReady.next(!0)})})()}openFoodCatalog(n){this.modalController.create({component:p.g,showBackdrop:!0,backdropDismiss:!1,canDismiss:(o,l)=>new Promise(i=>{n.callback&&n.callback(o),this.handleModalClosed(o),i(!0)}),componentProps:{title:n.title,canSelectItems:n.canSelectItems,canSelectPortions:n.canSelectPortions,canAddItems:n.canAddItems}}).then(o=>{o.present()})}handleModalClosed(n){}}return(t=a).\u0275fac=function(n){return new(n||t)(c.KVO(m.W3),c.KVO(h.BP),c.KVO(u.U))},t.\u0275prov=c.jDH({token:t,factory:t.\u0275fac,providedIn:"root"}),a})()},5293:(E,f,s)=>{s.d(f,{t:()=>m});var e=s(467),h=s(8581),_=s(9195),D=s(9275),p=s(4438),c=s(2038);let m=(()=>{var u;class d extends D.y{constructor(a,r){super(a,r),this.databaseService=a,this.loadingService=r}deleteDefaultData(){var a=this;let r=_.g.portions;return new Promise(n=>{let o=0;r.forEach(function(){var l=(0,e.A)(function*(i){if(yield a.deleteEntityFromDB(i.id),o++,o>=r.length)return n()});return function(i){return l.apply(this,arguments)}}())})}setupTableData(){this.tableName=h.jj.PORTION}setupDefaultData(a){var r=this;return(0,e.A)(function*(){var n;let o,l=null!==(n=r.tableName)&&void 0!==n?n:"ERROR",i=_.g.portions;r.databaseService.getDatabase().then(g=>(o=g,o.count(l))).then(g=>{g<=0||a?i.forEach(function(){var b=(0,e.A)(function*(C){yield r.createEntityInDB(o,C),i.indexOf(C)>=i.length-1&&r.dataReady.next(!0)});return function(C){return b.apply(this,arguments)}}()):r.dataReady.next(!0)})})()}}return(u=d).\u0275fac=function(a){return new(a||u)(p.KVO(h.BP),p.KVO(c.U))},u.\u0275prov=p.jDH({token:u,factory:u.\u0275fac,providedIn:"root"}),d})()}}]);