"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[742],{8361:(O,x,d)=>{d.d(x,{x:()=>S});var e=d(4438),t=d(2038),p=d(5293),k=d(4569),R=d(4988),M=d(4075),F=d(529),P=d(4464),b=d(177),I=d(4341),m=d(3819),C=d(9601);let v=(()=>{var l;class j{constructor(){this.valueChange=new e.bkB,this.onInputChanged=new e.bkB}ngOnInit(){}adjustValue(r){var i;let c=null!==(i=this.value)&&void 0!==i?i:0;c+=r,c=Math.max(c,0),this.value=c,this.valueChange.emit(c)}inputChanged(){this.onInputChanged.emit()}}return(l=j).\u0275fac=function(r){return new(r||l)},l.\u0275cmp=e.VBU({type:l,selectors:[["app-number-input"]],inputs:{label:"label",suffix:"suffix",placeholder:"placeholder",value:"value"},outputs:{valueChange:"valueChange",onInputChanged:"onInputChanged"},decls:13,vars:4,consts:[[1,"flex","flex-row","align-items-center","gap-2"],["size","2"],["shape","round","color","danger","fill","clear",3,"click"],["slot","icon-only","name","remove","size","small"],["fill","outline","type","number",1,"enhanced-visibility",3,"ngModelChange","ionInput","ngModel","placeholder"],["slot","end","aria-hidden","true"],["shape","round","color","success","fill","clear",3,"click"],["slot","icon-only","name","add","size","small"]],template:function(r,i){if(1&r&&(e.j41(0,"span",0)(1,"p"),e.EFF(2),e.k0s(),e.j41(3,"ion-col",1)(4,"ion-button",2),e.bIt("click",function(){return i.adjustValue(-5)}),e.nrm(5,"ion-icon",3),e.k0s()(),e.j41(6,"ion-col")(7,"ion-input",4),e.mxI("ngModelChange",function(G){return e.DH7(i.value,G)||(i.value=G),G}),e.bIt("ionInput",function(){return i.inputChanged()}),e.j41(8,"p",5),e.EFF(9),e.k0s()()(),e.j41(10,"ion-col",1)(11,"ion-button",6),e.bIt("click",function(){return i.adjustValue(5)}),e.nrm(12,"ion-icon",7),e.k0s()()()),2&r){let c;e.R7$(2),e.JRh(i.label),e.R7$(5),e.R50("ngModel",i.value),e.Y8G("placeholder",null!==(c=i.placeholder)&&void 0!==c?c:"enter value"),e.R7$(2),e.JRh(i.suffix)}},dependencies:[I.BC,I.vS,m.Jm,m.hU,m.iq,m.$w,m.su]}),j})();function T(l,j){if(1&l&&(e.j41(0,"h1")(1,"b"),e.EFF(2),e.k0s(),e.j41(3,"small"),e.EFF(4),e.nI1(5,"number"),e.k0s()()),2&l){const n=e.XpG(2);e.R7$(2),e.JRh(n.portionModel.name),e.R7$(2),e.Lme(" ",e.i5U(5,3,n.portionModel.measure,"1.0-1"),"",n.portionModel.unit,"")}}function B(l,j){if(1&l){const n=e.RV6();e.j41(0,"ion-input",17),e.mxI("ngModelChange",function(i){e.eBV(n);const c=e.XpG(2);return e.DH7(c.portionModel.name,i)||(c.portionModel.name=i),e.Njj(i)}),e.bIt("ionInput",function(){e.eBV(n);const i=e.XpG(2);return e.Njj(i.markModelChanged())}),e.k0s()}if(2&l){const n=e.XpG(2);e.R50("ngModel",n.portionModel.name)}}function _(l,j){if(1&l&&(e.j41(0,"h2"),e.EFF(1),e.k0s()),2&l){let n;const r=e.XpG(2);e.R7$(),e.JRh(null!==(n=r.portionModel.note)&&void 0!==n?n:"")}}function g(l,j){if(1&l){const n=e.RV6();e.j41(0,"ion-input",18),e.mxI("ngModelChange",function(i){e.eBV(n);const c=e.XpG(2);return e.DH7(c.portionModel.note,i)||(c.portionModel.note=i),e.Njj(i)}),e.bIt("ionInput",function(){e.eBV(n);const i=e.XpG(2);return e.Njj(i.markModelChanged())}),e.k0s()}if(2&l){const n=e.XpG(2);e.R50("ngModel",n.portionModel.note)}}function f(l,j){if(1&l){const n=e.RV6();e.j41(0,"ion-select",19),e.mxI("ngModelChange",function(i){e.eBV(n);const c=e.XpG(2);return e.DH7(c.portionModel.unit,i)||(c.portionModel.unit=i),e.Njj(i)}),e.j41(1,"ion-select-option",20),e.EFF(2,"grams"),e.k0s(),e.j41(3,"ion-select-option",21),e.EFF(4,"milliliters"),e.k0s()()}if(2&l){const n=e.XpG(2);e.R50("ngModel",n.portionModel.unit)}}function o(l,j){if(1&l){const n=e.RV6();e.j41(0,"app-number-input",22),e.mxI("valueChange",function(i){e.eBV(n);const c=e.XpG(2);return e.DH7(c.portionModel.measure,i)||(c.portionModel.measure=i),e.Njj(i)}),e.bIt("onInputChanged",function(){e.eBV(n);const i=e.XpG(2);return e.Njj(i.markModelChanged())}),e.k0s()}if(2&l){const n=e.XpG(2);e.Y8G("label","Measure: ")("suffix",n.portionModel.unit),e.R50("value",n.portionModel.measure)}}function h(l,j){if(1&l&&(e.j41(0,"h2")(1,"small"),e.EFF(2,"Carbs:"),e.k0s(),e.EFF(3),e.nI1(4,"number"),e.k0s()),2&l){const n=e.XpG(2);e.R7$(3),e.SpI(" ",e.i5U(4,1,n.portionModel.carbs,"1.0-1"),"g")}}function a(l,j){if(1&l){const n=e.RV6();e.j41(0,"app-number-input",23),e.mxI("valueChange",function(i){e.eBV(n);const c=e.XpG(2);return e.DH7(c.portionModel.carbs,i)||(c.portionModel.carbs=i),e.Njj(i)}),e.bIt("onInputChanged",function(){e.eBV(n);const i=e.XpG(2);return e.Njj(i.markModelChanged())}),e.k0s()}if(2&l){const n=e.XpG(2);e.Y8G("label","Carbs: ")("suffix","g"),e.R50("value",n.portionModel.carbs)}}function u(l,j){if(1&l){const n=e.RV6();e.j41(0,"ion-col",10)(1,"div",11)(2,"ion-button",24),e.bIt("click",function(){e.eBV(n);const i=e.XpG(2);return e.Njj(i.adjustPortion())}),e.EFF(3," Adjust "),e.nrm(4,"ion-icon",25),e.k0s()()()}}function s(l,j){if(1&l){const n=e.RV6();e.j41(0,"ion-button",26),e.bIt("click",function(){e.eBV(n);const i=e.XpG(2);return e.Njj(i.selectPortion())}),e.EFF(1," Select "),e.k0s()}}function E(l,j){if(1&l){const n=e.RV6();e.j41(0,"ion-button",30),e.bIt("click",function(){e.eBV(n);const i=e.XpG(3);return e.Njj(i.changeEditMode())}),e.nrm(1,"ion-icon",31),e.k0s()}if(2&l){const n=e.XpG(3);e.Y8G("disabled",n.editMode&&!n.portionModel.name),e.R7$(),e.Y8G("name",n.editMode?"save":"pencil")}}function D(l,j){if(1&l&&(e.j41(0,"ion-col",27)(1,"div",28),e.DNE(2,E,2,2,"ion-button",29),e.k0s()()),2&l){const n=e.XpG(2);e.R7$(2),e.Y8G("ngIf",n.portionModel.id)}}function y(l,j){if(1&l){const n=e.RV6();e.j41(0,"ion-grid")(1,"ion-row")(2,"ion-col",1)(3,"app-catalog-item",2),e.bIt("onItemClicked",function(i){e.eBV(n);const c=e.XpG();return e.Njj(c.onImageClicked(i))}),e.k0s()(),e.j41(4,"ion-col")(5,"p"),e.EFF(6),e.k0s(),e.j41(7,"ion-row"),e.DNE(8,T,6,6,"h1",0)(9,B,1,1,"ion-input",3),e.k0s(),e.j41(10,"ion-row"),e.DNE(11,_,2,1,"h2",0),e.j41(12,"div",4),e.DNE(13,g,1,1,"ion-input",5)(14,f,5,1,"ion-select",6),e.k0s()(),e.j41(15,"ion-row",7),e.DNE(16,o,1,3,"app-number-input",8),e.k0s(),e.j41(17,"ion-row",7),e.DNE(18,h,5,4,"h2",0)(19,a,1,3,"app-number-input",9),e.k0s()()(),e.j41(20,"ion-row")(21,"ion-col",10)(22,"div",11)(23,"ion-button",12),e.bIt("click",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.deletePortion())}),e.nrm(24,"ion-icon",13),e.k0s()()(),e.DNE(25,u,5,0,"ion-col",14)(26,s,2,0,"ion-button",15)(27,D,3,1,"ion-col",16),e.k0s()()}if(2&l){const n=e.XpG();e.R7$(3),e.Y8G("item",n.tempItem)("clickable",n.editMode)("showTitle",!1)("showIcons",!1)("animate",!1)("overlayIcon",n.editMode?"camera":"")("reloadEmitter",n.onImageChanged),e.R7$(3),e.JRh(n.catalogItemName),e.R7$(2),e.Y8G("ngIf",!n.editMode),e.R7$(),e.Y8G("ngIf",n.editMode),e.R7$(2),e.Y8G("ngIf",!n.editMode),e.R7$(2),e.Y8G("ngIf",n.editMode),e.R7$(),e.Y8G("ngIf",n.editMode),e.R7$(2),e.Y8G("ngIf",n.editMode),e.R7$(2),e.Y8G("ngIf",!n.editMode),e.R7$(),e.Y8G("ngIf",n.editMode),e.R7$(6),e.Y8G("ngIf",n.adjustable),e.R7$(),e.Y8G("ngIf",n.canSelectPortions&&n.portion.id&&!n.editMode),e.R7$(),e.Y8G("ngIf",n.allowEdit)}}let S=(()=>{var l;class j{constructor(r,i,c,G,N,V,A){this.loadingService=r,this.portionService=i,this.catalogService=c,this.alertService=G,this.imageService=N,this.messageService=V,this.modalService=A,this.allowDBDeletion=!1,this.allowEdit=!1,this.adjustable=!1,this.canSelectPortions=!1,this.onPortionDeleted=new e.bkB,this.onPortionSelected=new e.bkB,this.onImageChanged=new e.bkB,this.editMode=!1,this.modelChanged=!1,this.tempItem={name:"temp"}}ngOnInit(){!this.portion&&this.portionId?this.loadingService.addToQueue(this.portionService.getByKey(this.portionId).then(r=>{r?(this.portion=r,this.setup()):this.missingPortionData(this.portionId)})):this.setup()}missingPortionData(r){this.portion={name:"deleted",catalogItemId:-1,carbs:0,measure:0,unit:"g",note:"portion deleted"},this.portionModel={...this.portion}}setup(){this.portionModel=this.cloneItem(this.portion),this.tempItem.imageId=this.portion.imageId,""===this.portionModel.name?(this.editMode=!0,this.getCatalogItemName().then(r=>{this.catalogItemName=r,this.portionModel.name=r})):this.getCatalogItemName().then(r=>this.catalogItemName=r)}getCatalogItemName(){return this.catalogService.getPropertyByKey(this.portion.catalogItemId,"name")}cloneItem(r){return{...r}}markModelChanged(){this.modelChanged=!0}changeEditMode(){this.editMode&&this.savePortion(),this.editMode=!this.editMode}savePortion(){return new Promise(r=>{this.portion=this.cloneItem(this.portionModel),this.loadingService.addToQueue(this.portionService.saveItemToDB(this.portion).then(i=>(this.portion=i,r())))})}adjustCarbs(r){var i;let c=null!==(i=this.portionModel.carbs)&&void 0!==i?i:0;c+=r,c=Math.max(c,0),this.portionModel.carbs=c}deletePortion(){this.allowDBDeletion?this.alertService.promptConfirmation("Confirm","are you sure you want to delete this portion?","no","yes").then(r=>{r&&this.loadingService.addToQueue(this.portionService.deleteEntityFromDB(this.portion.id).then(()=>{this.onPortionDeleted.emit(this.portion)}))}):this.onPortionDeleted.emit(this.portion)}selectPortion(){this.onPortionSelected.emit(this.portion)}onImageClicked(r){this.imageService.userCreateImage().then(i=>{var c;i?(this.portionModel.imageId=null!==(c=i.id)&&void 0!==c?c:0,this.savePortion().then(()=>{this.tempItem.imageId=this.portionModel.imageId,this.onImageChanged.emit()})):this.messageService.display("Photo upload cancelled.")})}adjustPortion(){let i=this.portionModel.measure;this.modalService.presentSliderModal("Adjust portion","Adjust portion size",i,.1*this.portionModel.measure,2*this.portionModel.measure,this.portionModel.unit,!0).then(N=>{N.confirmed&&(i=N.data.data.result,this.applyPortionAdjustment(i))})}applyPortionAdjustment(r){let c=this.portionModel.carbs*(r/(this.portionModel.measure/100)/100);this.portionModel.carbs=c,this.portion.carbs=c,this.portionModel.measure=r,this.portion.measure=r}}return(l=j).\u0275fac=function(r){return new(r||l)(e.rXU(t.U),e.rXU(p.t),e.rXU(k.H),e.rXU(R.u),e.rXU(M.f),e.rXU(F.b),e.rXU(P.B))},l.\u0275cmp=e.VBU({type:l,selectors:[["app-portion"]],inputs:{portion:"portion",portionId:"portionId",listPosition:"listPosition",allowDBDeletion:"allowDBDeletion",allowEdit:"allowEdit",adjustable:"adjustable",canSelectPortions:"canSelectPortions"},outputs:{onPortionDeleted:"onPortionDeleted",onPortionSelected:"onPortionSelected",onImageChanged:"onImageChanged"},decls:1,vars:1,consts:[[4,"ngIf"],["size","auto"],[3,"onItemClicked","item","clickable","showTitle","showIcons","animate","overlayIcon","reloadEmitter"],["class","enhanced-visibility","fill","outline","type","text","placeholder","enter name",3,"ngModel","ngModelChange","ionInput",4,"ngIf"],[1,"flex"],["class","enhanced-visibility","fill","outline","type","text","placeholder","enter note",3,"ngModel","ngModelChange","ionInput",4,"ngIf"],["label","",3,"ngModel","ngModelChange",4,"ngIf"],[1,"flex","flex-row","align-items-center","gap-2"],["placeholder","enter measure",3,"label","suffix","value","valueChange","onInputChanged",4,"ngIf"],["placeholder","enter carbs",3,"label","suffix","value","valueChange","onInputChanged",4,"ngIf"],[1,"flex","justify-content-start","align-items-center"],[1,"flex","align-items-start"],["item-start","","fill","clear","color","danger",3,"click"],["slot","icon-only","name","trash"],["class","flex justify-content-start align-items-center",4,"ngIf"],["size","small","shape","round","color","warning","fill","outline",3,"click",4,"ngIf"],["class","flex justify-content-end",4,"ngIf"],["fill","outline","type","text","placeholder","enter name",1,"enhanced-visibility",3,"ngModelChange","ionInput","ngModel"],["fill","outline","type","text","placeholder","enter note",1,"enhanced-visibility",3,"ngModelChange","ionInput","ngModel"],["label","",3,"ngModelChange","ngModel"],["value","g"],["value","ml"],["placeholder","enter measure",3,"valueChange","onInputChanged","label","suffix","value"],["placeholder","enter carbs",3,"valueChange","onInputChanged","label","suffix","value"],["item-start","","fill","clear","color","warning",3,"click"],["slot","end","name","options"],["size","small","shape","round","color","warning","fill","outline",3,"click"],[1,"flex","justify-content-end"],[1,"flex","align-items-end"],["item-end","","fill","clear","color","medium",3,"disabled","click",4,"ngIf"],["item-end","","fill","clear","color","medium",3,"click","disabled"],["slot","icon-only",3,"name"]],template:function(r,i){1&r&&e.DNE(0,y,28,19,"ion-grid",0),2&r&&e.Y8G("ngIf",i.portionModel)},dependencies:[b.bT,I.BC,I.vS,m.Jm,m.hU,m.lO,m.iq,m.$w,m.ln,m.Nm,m.Ip,m.Je,m.Gw,C.I,v,b.QX]}),j})()},8385:(O,x,d)=>{d.d(x,{g:()=>R});var e=d(4438),t=d(3819);function p(M,F){if(1&M&&(e.j41(0,"p")(1,"b"),e.EFF(2),e.k0s()()),2&M){const P=e.XpG();e.R7$(2),e.SpI("",P.selectedItems.length," items selected")}}function k(M,F){if(1&M&&(e.j41(0,"p")(1,"b"),e.EFF(2),e.k0s()()),2&M){const P=e.XpG();e.R7$(2),e.SpI("",P.selectedPortions.length," portions selected")}}let R=(()=>{var M;class F{constructor(b){this.modalController=b,this.title="Catalog",this.canAddItems=!1,this.canSelectItems=!1,this.canSelectPortions=!1,this.returnData={},this.selectedItems=[],this.selectedPortions=[]}ngOnInit(){}dismiss(){return this.modalController.dismiss(this.constructReturnData("dismiss"))}confirm(){return this.modalController.dismiss(this.constructReturnData("confirmSelection"))}itemSelected(b){-1==this.selectedItems.indexOf(b)&&this.selectedItems.push(b)}portionSelected(b){-1==this.selectedPortions.indexOf(b)&&this.selectedPortions.push(b)}constructReturnData(b){let I={...this.returnData};return I.returnedItems=this.selectedItems,I.returnedPortions=this.selectedPortions,I}}return(M=F).\u0275fac=function(b){return new(b||M)(e.rXU(t.W3))},M.\u0275cmp=e.VBU({type:M,selectors:[["app-food-catalog-modal"]],decls:24,vars:9,consts:[["catalogheader",""],["catalog",""],["slot","end"],["color","medium",3,"click"],["name","close"],[3,"translucent"],["headerMode","none",3,"segmentChanged"],[3,"fullscreen"],[3,"onItemSelected","onPortionSelected","onSelectionComplete","segmentChanged","canAddItems","canSelectPortions","canSelectItems"],[3,"searchTermChanged"],[4,"ngIf"],["color","success","fill","outline",3,"click","strong"]],template:function(b,I){if(1&b){const m=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3),e.k0s(),e.j41(4,"ion-buttons",2)(5,"ion-button",3),e.bIt("click",function(){return e.eBV(m),e.Njj(I.dismiss())}),e.nrm(6,"ion-icon",4),e.k0s()()()(),e.j41(7,"ion-header",5)(8,"app-food-catalog-header",6,0),e.bIt("segmentChanged",function(v){e.eBV(m);const T=e.sdS(12);return e.Njj(T.handleSegmentChanged(v))}),e.k0s()(),e.j41(10,"ion-content",7)(11,"app-food-catalog",8,1),e.bIt("onItemSelected",function(v){return e.eBV(m),e.Njj(I.itemSelected(v))})("onPortionSelected",function(v){return e.eBV(m),e.Njj(I.portionSelected(v))})("onSelectionComplete",function(){return e.eBV(m),e.Njj(I.confirm())})("segmentChanged",function(v){e.eBV(m);const T=e.sdS(9);return e.Njj(T.handleSegmentChanged(v))}),e.k0s()(),e.j41(13,"ion-footer")(14,"app-food-catalog-footer",9),e.bIt("searchTermChanged",function(v){e.eBV(m);const T=e.sdS(12);return e.Njj(T.handleSearchTermChanged(v))}),e.k0s()(),e.j41(15,"ion-footer")(16,"ion-toolbar"),e.DNE(17,p,3,1,"p",10)(18,k,3,1,"p",10),e.j41(19,"ion-buttons",2)(20,"ion-button",3),e.bIt("click",function(){return e.eBV(m),e.Njj(I.dismiss())}),e.EFF(21," Cancel "),e.k0s(),e.j41(22,"ion-button",11),e.bIt("click",function(){return e.eBV(m),e.Njj(I.confirm())}),e.EFF(23,"Confirm"),e.k0s()()()()}2&b&&(e.R7$(3),e.JRh(I.title),e.R7$(4),e.Y8G("translucent",!0),e.R7$(3),e.Y8G("fullscreen",!0),e.R7$(),e.Y8G("canAddItems",I.canAddItems)("canSelectPortions",I.canSelectPortions)("canSelectItems",I.canSelectItems),e.R7$(6),e.Y8G("ngIf",I.canSelectItems),e.R7$(),e.Y8G("ngIf",I.canSelectPortions),e.R7$(4),e.Y8G("strong",!0))}}),F})()},4569:(O,x,d)=>{d.d(x,{H:()=>C});var e=d(467),t=d(8581),p=d(9195),k=d(9275),R=d(8385),M=d(4438),F=d(3819),P=d(5293),b=d(4075),I=d(8317),m=d(2038);let C=(()=>{var v;class T extends k.y{constructor(_,g,f,o,h,a){super(h,a),this.modalController=_,this.portionService=g,this.imageService=f,this.imageCaptureService=o,this.databaseService=h,this.loadingService=a}deleteDefaultData(){var _=this;let g=p.g.catalogItems;return new Promise(f=>{let o=0;g.forEach(function(){var h=(0,e.A)(function*(a){if(yield _.deleteEntityFromDB(a.id),o++,o>=g.length)return f()});return function(a){return h.apply(this,arguments)}}())})}setupTableData(){this.tableName=t.jj.CATALOG_ITEM}setupDefaultData(_){var g=this;return(0,e.A)(function*(){let f;g.databaseService.getDatabase().then(o=>(f=o,f.count(t.jj.CATALOG_ITEM))).then(o=>{o<=0||_?p.g.catalogItems.forEach(function(){var h=(0,e.A)(function*(a){yield g.createEntityInDB(f,a),p.g.catalogItems.indexOf(a)>=p.g.catalogItems.length-1&&(g.reserveDatabaseEntries(),g.dataReady.next(!0))});return function(a){return h.apply(this,arguments)}}()):(g.reserveDatabaseEntries(),g.dataReady.next(!0))})})()}openFoodCatalog(_){this.modalController.create({component:R.g,showBackdrop:!0,backdropDismiss:!1,canDismiss:(g,f)=>new Promise(o=>{_.callback&&_.callback(g),this.handleModalClosed(g),o(!0)}),componentProps:{title:_.title,canSelectItems:_.canSelectItems,canSelectPortions:_.canSelectPortions,canAddItems:_.canAddItems}}).then(g=>{g.present()})}handleModalClosed(_){}getExportableItemData(_){var g=this;let f={portions:[],images:[]},o=[];return new Promise(function(){var h=(0,e.A)(function*(a){_=yield g.getByKey(_.id),f.catalogItem=_,null!=_.imageId&&o.push(_.imageId);let u=yield g.portionService.getAllForIndex(t.$I.PORTION_TBL_CATALOG_ITEM_ID,_.id);if(f.portions=u,u.forEach(s=>{null!=s.imageId&&o.push(s.imageId)}),o=Array.from(new Set(o)),o.length<=0)return a(f);o.forEach(function(){var s=(0,e.A)(function*(E){var D,y;let S=yield g.imageService.getByKey(E),l=yield g.imageService.getImageData(S);if(S.imageData=l,null===(D=f.images)||void 0===D||D.push(S),f.images&&(null===(y=f.images)||void 0===y?void 0:y.length)>=o.length)return a(f)});return function(E){return s.apply(this,arguments)}}())});return function(a){return h.apply(this,arguments)}}())}devHandleImportedData(_){var g=this;return new Promise(function(){var f=(0,e.A)(function*(o){var h;let a=null!==(h=null==_?void 0:_.images)&&void 0!==h?h:[],u=0,s=0;if(a.length<=0)return o(_);a.forEach(function(){var E=(0,e.A)(function*(D){var y,S,l;u++;let j=g.constructImageNameFromItem(null!==(y=null===(S=_.catalogItem)||void 0===S?void 0:S.name)&&void 0!==y?y:"item.jpg",u),n=D.imagePath.split(".")[1];D.imagePath=j+n;let r=null!==(l=D.imageData)&&void 0!==l?l:"no-data";if(yield g.imageCaptureService.devSaveBase64DataToDefaultsFolder(j,r),D.imageData=void 0,s++,s>=a.length)return o(_)});return function(D){return E.apply(this,arguments)}}())});return function(o){return f.apply(this,arguments)}}())}constructImageNameFromItem(_,g){let f=_;return f=f.toLowerCase(),f=f.replace(/ /g,"-"),f=`${f}-${g}`,f}}return(v=T).\u0275fac=function(_){return new(_||v)(M.KVO(F.W3),M.KVO(P.t),M.KVO(b.f),M.KVO(I.X),M.KVO(t.BP),M.KVO(m.U))},v.\u0275prov=M.jDH({token:v,factory:v.\u0275fac,providedIn:"root"}),T})()},4464:(O,x,d)=>{d.d(x,{B:()=>f});var e=d(467),t=d(4438),p=d(3819),k=d(177),R=d(4341);function M(o,h){1&o&&t.eu8(0)}function F(o,h){1&o&&(t.j41(0,"ion-text",14)(1,"small"),t.EFF(2,"This field is required."),t.k0s()())}function P(o,h){if(1&o){const a=t.RV6();t.j41(0,"ion-input",12),t.mxI("ngModelChange",function(s){t.eBV(a);const E=t.XpG().$implicit;return t.DH7(E.value,s)||(E.value=s),t.Njj(s)}),t.k0s(),t.DNE(1,F,3,0,"ion-text",13)}if(2&o){const a=t.XpG().$implicit;t.AVh("required",(null==a.attributes?null:a.attributes.required)&&!a.value),t.R50("ngModel",a.value),t.Y8G("type",a.type)("label",(null!=a.attributes&&a.attributes.required?"*":"")+a.label)("placeholder",a.placeholder),t.R7$(),t.Y8G("ngIf",(null==a.attributes?null:a.attributes.required)&&!a.value)}}function b(o,h){1&o&&t.eu8(0)}function I(o,h){if(1&o&&(t.j41(0,"ion-select-option",17),t.EFF(1),t.k0s()),2&o){const a=h.$implicit;t.Y8G("value",a),t.R7$(),t.SpI(" ",a," ")}}function m(o,h){1&o&&(t.j41(0,"ion-text",14)(1,"small"),t.EFF(2,"required"),t.k0s()())}function C(o,h){if(1&o){const a=t.RV6();t.j41(0,"ion-select",15),t.mxI("ngModelChange",function(s){t.eBV(a);const E=t.XpG(2).$implicit;return t.DH7(E.value,s)||(E.value=s),t.Njj(s)}),t.DNE(1,I,2,2,"ion-select-option",16),t.k0s(),t.DNE(2,m,3,0,"ion-text",13)}if(2&o){const a=t.XpG(2).$implicit;t.AVh("required",(null==a.attributes?null:a.attributes.required)&&!a.value),t.Y8G("label",(null!=a.attributes&&a.attributes.required?"*":"")+a.label)("placeholder",a.placeholder)("value",a.value),t.R50("ngModel",a.value),t.R7$(),t.Y8G("ngForOf",null==a.options?null:a.options.choices),t.R7$(),t.Y8G("ngIf",(null==a.attributes?null:a.attributes.required)&&!a.value)}}function v(o,h){if(1&o&&t.DNE(0,b,1,0,"ng-container",11)(1,C,3,8,"ng-template",null,3,t.C5r),2&o){const a=t.sdS(2),u=t.XpG().$implicit;t.XpG();const s=t.sdS(17);t.Y8G("ngIf","dropdown"===u.altType)("ngIfThen",a)("ngIfElse",s)}}function T(o,h){if(1&o&&(t.j41(0,"div")(1,"ion-item"),t.DNE(2,M,1,0,"ng-container",11)(3,P,2,7,"ng-template",null,1,t.C5r)(5,v,3,3,"ng-template",null,2,t.C5r),t.k0s()()),2&o){const a=h.$implicit,u=t.sdS(4),s=t.sdS(6);t.R7$(2),t.Y8G("ngIf",!a.altType)("ngIfThen",u)("ngIfElse",s)}}function B(o,h){1&o&&t.EFF(0," not implemented\n")}let _=(()=>{var o;class h{constructor(u){this.modalController=u}ngOnInit(){}isValid(){return this.inputs.every(u=>{var s;return!(null!==(s=u.attributes)&&void 0!==s&&s.required)||u.value})}dismiss(u){this.modalController.dismiss({data:this.getFormData()},u?"confirm":"cancel")}confirm(){this.isValid()&&this.dismiss(!0)}getFormData(){const u={};return this.inputs.forEach(s=>{u[s.name]=s.value}),u}}return(o=h).\u0275fac=function(u){return new(u||o)(t.rXU(p.W3))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-input-modal"]],inputs:{title:"title",message:"message",inputs:"inputs"},decls:18,vars:5,consts:[["notImplementedType",""],["type",""],["altType",""],["dropdownType",""],[3,"fullscreen"],[1,"mx-2"],[4,"ngFor","ngForOf"],["slot","start"],[3,"click"],["slot","end"],["color","success","fill","outline",3,"click","disabled"],[4,"ngIf","ngIfThen","ngIfElse"],["required","","labelPlacement","stacked",3,"ngModelChange","ngModel","type","label","placeholder"],["color","danger",4,"ngIf"],["color","danger"],["justify","start","interface","action-sheet",3,"ngModelChange","label","placeholder","value","ngModel"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(u,s){if(1&u){const E=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3),t.k0s()()(),t.j41(4,"ion-content",4)(5,"p",5),t.EFF(6),t.k0s(),t.DNE(7,T,7,3,"div",6),t.k0s(),t.j41(8,"ion-footer")(9,"ion-toolbar")(10,"ion-buttons",7)(11,"ion-button",8),t.bIt("click",function(){return t.eBV(E),t.Njj(s.dismiss(!1))}),t.EFF(12,"Cancel"),t.k0s()(),t.j41(13,"ion-buttons",9)(14,"ion-button",10),t.bIt("click",function(){return t.eBV(E),t.Njj(s.confirm())}),t.EFF(15,"Confirm"),t.k0s()()()(),t.DNE(16,B,1,0,"ng-template",null,0,t.C5r)}2&u&&(t.R7$(3),t.JRh(s.title),t.R7$(),t.Y8G("fullscreen",!0),t.R7$(2),t.JRh(s.message),t.R7$(),t.Y8G("ngForOf",s.inputs),t.R7$(7),t.Y8G("disabled",!s.isValid()))},dependencies:[k.Sq,k.bT,R.BC,R.YS,R.vS,p.Jm,p.QW,p.W9,p.M0,p.eU,p.$w,p.uz,p.Nm,p.Ip,p.IO,p.BC,p.ai,p.Je,p.Gw],styles:[".required[_ngcontent-%COMP%]{border-bottom:1px solid red}"]}),h})(),g=(()=>{var o;class h{constructor(u){this.modalController=u}ngOnInit(){}dismiss(u){this.modalController.dismiss({data:{result:this.value}},u?"confirm":"cancel")}confirm(){this.dismiss(!0)}}return(o=h).\u0275fac=function(u){return new(u||o)(t.rXU(p.W3))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-slider-modal"]],inputs:{title:"title",message:"message",unit:"unit",value:"value",min:"min",max:"max"},decls:27,vars:20,consts:[[1,"m-3"],[3,"ngModelChange","ngModel","min","max"],["slot","start","name","snow-outline"],["slot","end","name","sunny-outline"],["slot","start"],[3,"click"],["slot","end"],["color","success","fill","outline",3,"click"]],template:function(u,s){1&u&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3),t.k0s()()(),t.j41(4,"ion-content")(5,"div",0)(6,"p"),t.EFF(7),t.k0s(),t.j41(8,"ion-range",1),t.mxI("ngModelChange",function(D){return t.DH7(s.value,D)||(s.value=D),D}),t.j41(9,"p",2),t.EFF(10),t.nI1(11,"number"),t.k0s(),t.j41(12,"p",3),t.EFF(13),t.nI1(14,"number"),t.k0s()(),t.j41(15,"p")(16,"b"),t.EFF(17),t.nI1(18,"number"),t.k0s()()()(),t.j41(19,"ion-footer")(20,"ion-toolbar")(21,"ion-buttons",4)(22,"ion-button",5),t.bIt("click",function(){return s.dismiss(!1)}),t.EFF(23,"Cancel"),t.k0s()(),t.j41(24,"ion-buttons",6)(25,"ion-button",7),t.bIt("click",function(){return s.confirm()}),t.EFF(26,"Confirm"),t.k0s()()()()),2&u&&(t.R7$(3),t.JRh(s.title),t.R7$(4),t.JRh(s.message),t.R7$(),t.R50("ngModel",s.value),t.Y8G("min",s.min)("max",s.max),t.R7$(2),t.Lme("",t.i5U(11,11,s.min,"1.0-1"),"",s.unit,""),t.R7$(3),t.Lme("",t.i5U(14,14,s.max,"1.0-1"),"",s.unit,""),t.R7$(4),t.Lme("",t.i5U(18,17,s.value,"1.0-1"),"",s.unit,""))},dependencies:[R.BC,R.vS,p.Jm,p.QW,p.W9,p.M0,p.eU,p.Ob,p.BC,p.ai,p.su,k.QX]}),h})(),f=(()=>{var o;class h{constructor(u){this.modalController=u}presentInputModal(u,s,E,D=!1){var y=this;return(0,e.A)(function*(){const S=yield y.modalController.create({component:_,backdropDismiss:D,componentProps:{inputs:u,title:s,message:E},cssClass:"small-modal",showBackdrop:!0});yield S.present();const l=yield S.onDidDismiss();return{data:l.data||{},confirmed:"confirm"===l.role}})()}presentSliderModal(u,s,E,D,y,S,l=!1){var j=this;return(0,e.A)(function*(){const n=yield j.modalController.create({component:g,backdropDismiss:l,componentProps:{value:E,min:D,max:y,title:u,message:s,unit:S},cssClass:"small-modal",showBackdrop:!0});yield n.present();const r=yield n.onDidDismiss();return{data:r.data||{},confirmed:"confirm"===r.role}})()}}return(o=h).\u0275fac=function(u){return new(u||o)(t.KVO(p.W3))},o.\u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"}),h})()},5293:(O,x,d)=>{d.d(x,{t:()=>F});var e=d(467),t=d(8581),p=d(9195),k=d(9275),R=d(4438),M=d(2038);let F=(()=>{var P;class b extends k.y{constructor(m,C){super(m,C),this.databaseService=m,this.loadingService=C}deleteDefaultData(){var m=this;let C=p.g.portions;return new Promise(v=>{let T=0;C.forEach(function(){var B=(0,e.A)(function*(_){if(yield m.deleteEntityFromDB(_.id),T++,T>=C.length)return v()});return function(_){return B.apply(this,arguments)}}())})}setupTableData(){this.tableName=t.jj.PORTION}setupDefaultData(m){var C=this;return(0,e.A)(function*(){var v;let T,B=null!==(v=C.tableName)&&void 0!==v?v:"ERROR",_=p.g.portions;C.databaseService.getDatabase().then(g=>(T=g,T.count(B))).then(g=>{g<=0||m?_.forEach(function(){var f=(0,e.A)(function*(o){yield C.createEntityInDB(T,o),_.indexOf(o)>=_.length-1&&(C.reserveDatabaseEntries(),C.dataReady.next(!0))});return function(o){return f.apply(this,arguments)}}()):(C.reserveDatabaseEntries(),C.dataReady.next(!0))})})()}}return(P=b).\u0275fac=function(m){return new(m||P)(R.KVO(t.BP),R.KVO(M.U))},P.\u0275prov=R.jDH({token:P,factory:P.\u0275fac,providedIn:"root"}),b})()}}]);