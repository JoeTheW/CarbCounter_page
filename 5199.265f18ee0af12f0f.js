"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5199],{9385:(C,P,r)=>{r.d(P,{x:()=>y});var o=r(4438),g=r(2038),c=r(5293),d=r(4569),u=r(4988),m=r(177),f=r(4341),l=r(3819),M=r(9601);function I(n,a){if(1&n&&(o.j41(0,"h1"),o.EFF(1),o.k0s()),2&n){const t=o.XpG(2);o.R7$(),o.JRh(t.portionModel.name)}}function s(n,a){if(1&n){const t=o.RV6();o.j41(0,"ion-input",15),o.mxI("ngModelChange",function(i){o.eBV(t);const _=o.XpG(2);return o.DH7(_.portionModel.name,i)||(_.portionModel.name=i),o.Njj(i)}),o.bIt("ionInput",function(){o.eBV(t);const i=o.XpG(2);return o.Njj(i.markModelChanged())}),o.k0s()}if(2&n){const t=o.XpG(2);o.R50("ngModel",t.portionModel.name)}}function p(n,a){if(1&n&&(o.j41(0,"h2"),o.EFF(1),o.k0s()),2&n){let t;const e=o.XpG(2);o.R7$(),o.JRh(null!==(t=e.portionModel.note)&&void 0!==t?t:"-")}}function h(n,a){if(1&n){const t=o.RV6();o.j41(0,"ion-input",16),o.mxI("ngModelChange",function(i){o.eBV(t);const _=o.XpG(2);return o.DH7(_.portionModel.note,i)||(_.portionModel.note=i),o.Njj(i)}),o.bIt("ionInput",function(){o.eBV(t);const i=o.XpG(2);return o.Njj(i.markModelChanged())}),o.k0s()}if(2&n){const t=o.XpG(2);o.R50("ngModel",t.portionModel.note)}}function D(n,a){if(1&n&&(o.j41(0,"h2"),o.EFF(1),o.k0s()),2&n){const t=o.XpG(2);o.R7$(),o.SpI("",t.portionModel.carbs,"g")}}function E(n,a){if(1&n){const t=o.RV6();o.j41(0,"ion-button",17),o.bIt("click",function(){o.eBV(t);const i=o.XpG(2);return o.Njj(i.adjustCarbs(-5))}),o.nrm(1,"ion-icon",18),o.k0s()}}function v(n,a){if(1&n){const t=o.RV6();o.j41(0,"ion-input",19),o.mxI("ngModelChange",function(i){o.eBV(t);const _=o.XpG(2);return o.DH7(_.portionModel.carbs,i)||(_.portionModel.carbs=i),o.Njj(i)}),o.bIt("ionInput",function(){o.eBV(t);const i=o.XpG(2);return o.Njj(i.markModelChanged())}),o.k0s()}if(2&n){const t=o.XpG(2);o.R50("ngModel",t.portionModel.carbs)}}function b(n,a){if(1&n){const t=o.RV6();o.j41(0,"ion-button",20),o.bIt("click",function(){o.eBV(t);const i=o.XpG(2);return o.Njj(i.adjustCarbs(5))}),o.nrm(1,"ion-icon",21),o.k0s()}}function j(n,a){if(1&n){const t=o.RV6();o.j41(0,"ion-button",22),o.bIt("click",function(){o.eBV(t);const i=o.XpG(2);return o.Njj(i.selectPortion())}),o.EFF(1," Select "),o.k0s()}}function R(n,a){if(1&n){const t=o.RV6();o.j41(0,"ion-button",26),o.bIt("click",function(){o.eBV(t);const i=o.XpG(3);return o.Njj(i.changeEditMode())}),o.nrm(1,"ion-icon",27),o.k0s()}if(2&n){const t=o.XpG(3);o.Y8G("disabled",t.editMode&&!t.portionModel.name),o.R7$(),o.Y8G("name",t.editMode?"save":"pencil")}}function T(n,a){if(1&n&&(o.j41(0,"ion-col",23)(1,"div",24),o.DNE(2,R,2,2,"ion-button",25),o.k0s()()),2&n){const t=o.XpG(2);o.R7$(2),o.Y8G("ngIf",t.portionModel.id)}}function x(n,a){if(1&n){const t=o.RV6();o.j41(0,"ion-grid")(1,"ion-row")(2,"ion-col",1),o.nrm(3,"app-catalog-item",2),o.k0s(),o.j41(4,"ion-col")(5,"p"),o.EFF(6),o.k0s(),o.j41(7,"ion-row"),o.DNE(8,I,2,1,"h1",0)(9,s,1,1,"ion-input",3),o.k0s(),o.j41(10,"ion-row"),o.DNE(11,p,2,1,"h2",0)(12,h,1,1,"ion-input",4),o.k0s(),o.j41(13,"ion-row",5),o.DNE(14,D,2,1,"h2",0),o.j41(15,"ion-col",1),o.DNE(16,E,2,0,"ion-button",6),o.k0s(),o.j41(17,"ion-col"),o.DNE(18,v,1,1,"ion-input",7),o.k0s(),o.j41(19,"ion-col",1),o.DNE(20,b,2,0,"ion-button",8),o.k0s()()()(),o.j41(21,"ion-row")(22,"ion-col",9)(23,"div",10)(24,"ion-button",11),o.bIt("click",function(){o.eBV(t);const i=o.XpG();return o.Njj(i.deletePortion())}),o.nrm(25,"ion-icon",12),o.k0s()()(),o.DNE(26,j,2,0,"ion-button",13)(27,T,3,1,"ion-col",14),o.k0s()()}if(2&n){const t=o.XpG();o.R7$(3),o.Y8G("item",t.tempItem)("clickable",!1)("showTitle",!1)("showIcons",!1)("animate",!1)("overlayIcon",t.editMode?"camera":""),o.R7$(3),o.JRh(t.catalogItemName),o.R7$(2),o.Y8G("ngIf",!t.editMode),o.R7$(),o.Y8G("ngIf",t.editMode),o.R7$(2),o.Y8G("ngIf",!t.editMode),o.R7$(),o.Y8G("ngIf",t.editMode),o.R7$(2),o.Y8G("ngIf",!t.editMode),o.R7$(2),o.Y8G("ngIf",t.editMode),o.R7$(2),o.Y8G("ngIf",t.editMode),o.R7$(2),o.Y8G("ngIf",t.editMode),o.R7$(6),o.Y8G("ngIf",t.canSelectPortions&&t.portion.id&&!t.editMode),o.R7$(),o.Y8G("ngIf",t.allowEdit)}}let y=(()=>{var n;class a{constructor(e,i,_,G){this.loadingService=e,this.portionService=i,this.catalogService=_,this.alertService=G,this.allowDBDeletion=!1,this.allowEdit=!1,this.canSelectPortions=!1,this.onPortionDeleted=new o.bkB,this.onPortionSelected=new o.bkB,this.editMode=!1,this.modelChanged=!1,this.tempItem={name:"temp"}}ngOnInit(){!this.portion&&this.portionId?this.loadingService.addToQueue(this.portionService.getByKey(this.portionId).then(e=>{e?(this.portion=e,this.setup()):this.missingPortionData(this.portionId)})):this.setup()}missingPortionData(e){this.portion={name:"deleted",catalogItemId:-1,carbs:0,note:"portion deleted"},this.portionModel={...this.portion}}setup(){this.portionModel=this.cloneItem(this.portion),this.tempItem.image=this.portion.image,""===this.portionModel.name?(this.editMode=!0,this.getCatalogItemName().then(e=>{this.catalogItemName=e,this.portionModel.name=e})):this.getCatalogItemName().then(e=>this.catalogItemName=e)}getCatalogItemName(){return this.catalogService.getPropertyByKey(this.portion.catalogItemId,"name")}cloneItem(e){return{...e}}markModelChanged(){this.modelChanged=!0}changeEditMode(){this.editMode&&this.savePortion(),this.editMode=!this.editMode}savePortion(){this.portion=this.cloneItem(this.portionModel),this.loadingService.addToQueue(this.portionService.saveItemToDB(this.portion).then(e=>{this.portion=e}))}adjustCarbs(e){var i;let _=null!==(i=this.portionModel.carbs)&&void 0!==i?i:0;_+=e,_=Math.max(_,0),this.portionModel.carbs=_}deletePortion(){this.allowDBDeletion?this.alertService.promptConfirmation("Confirm","are you sure you want to delete this portion?","no","yes").then(e=>{e&&this.loadingService.addToQueue(this.portionService.deleteEntityFromDB(this.portion.id).then(()=>{this.onPortionDeleted.emit(this.portion)}))}):this.onPortionDeleted.emit(this.portion)}selectPortion(){this.onPortionSelected.emit(this.portion)}}return(n=a).\u0275fac=function(e){return new(e||n)(o.rXU(g.U),o.rXU(c.t),o.rXU(d.H),o.rXU(u.u))},n.\u0275cmp=o.VBU({type:n,selectors:[["app-portion"]],inputs:{portion:"portion",portionId:"portionId",listPosition:"listPosition",allowDBDeletion:"allowDBDeletion",allowEdit:"allowEdit",canSelectPortions:"canSelectPortions"},outputs:{onPortionDeleted:"onPortionDeleted",onPortionSelected:"onPortionSelected"},decls:1,vars:1,consts:[[4,"ngIf"],["size","auto"],[3,"item","clickable","showTitle","showIcons","animate","overlayIcon"],["class","enhanced-visibility","fill","outline","type","text","placeholder","enter name",3,"ngModel","ngModelChange","ionInput",4,"ngIf"],["class","enhanced-visibility","fill","outline","type","text","placeholder","enter note",3,"ngModel","ngModelChange","ionInput",4,"ngIf"],[1,"flex","flex-row","align-items-center","gap-2"],["shape","round","color","danger","fill","clear",3,"click",4,"ngIf"],["class","enhanced-visibility","fill","outline","type","number","placeholder","enter carbs",3,"ngModel","ngModelChange","ionInput",4,"ngIf"],["shape","round","color","success","fill","clear",3,"click",4,"ngIf"],[1,"flex","justify-content-start"],[1,"flex","align-items-start"],["item-start","","fill","clear","color","danger",3,"click"],["slot","icon-only","name","trash"],["size","small","shape","round","color","warning","fill","outline",3,"click",4,"ngIf"],["class","flex justify-content-end",4,"ngIf"],["fill","outline","type","text","placeholder","enter name",1,"enhanced-visibility",3,"ngModelChange","ionInput","ngModel"],["fill","outline","type","text","placeholder","enter note",1,"enhanced-visibility",3,"ngModelChange","ionInput","ngModel"],["shape","round","color","danger","fill","clear",3,"click"],["slot","icon-only","name","remove","size","small"],["fill","outline","type","number","placeholder","enter carbs",1,"enhanced-visibility",3,"ngModelChange","ionInput","ngModel"],["shape","round","color","success","fill","clear",3,"click"],["slot","icon-only","name","add","size","small"],["size","small","shape","round","color","warning","fill","outline",3,"click"],[1,"flex","justify-content-end"],[1,"flex","align-items-end"],["item-end","","fill","clear","color","medium",3,"disabled","click",4,"ngIf"],["item-end","","fill","clear","color","medium",3,"click","disabled"],["slot","icon-only",3,"name"]],template:function(e,i){1&e&&o.DNE(0,x,28,17,"ion-grid",0),2&e&&o.Y8G("ngIf",i.portionModel)},dependencies:[m.bT,f.BC,f.vS,l.Jm,l.hU,l.lO,l.iq,l.$w,l.ln,l.su,l.Gw,M.I]}),a})()},9715:(C,P,r)=>{r.d(P,{$:()=>g});var o=r(4438);let g=(()=>{var c;class d{transform(m,f){return m?m.reduce((l,M)=>l+(M[f]||0),0):0}}return(c=d).\u0275fac=function(m){return new(m||c)},c.\u0275pipe=o.EJ8({name:"sumProperty",type:c,pure:!1}),d})()},7225:(C,P,r)=>{r.d(P,{i:()=>f});var o=r(467),g=r(8581),c=r(9275),d=r(1799),u=r(4438),m=r(2038);let f=(()=>{var l;class M extends c.y{constructor(s,p,h){super(s,p),this.databaseService=s,this.loadingService=p,this.systemService=h,this.carbTotal=134,this.carbGoal=250}deleteDefaultData(){return new Promise(s=>s())}setupTableData(){this.tableName=g.jj.FOOD_LOG}setupDefaultData(s){var p=this;return(0,o.A)(function*(){return p.dataReady.next(!0),new Promise(h=>h())})()}getDailyCarbGoal(){return new Promise(s=>{this.systemService.getConfigValue(d.c.DAILY_CARB_GOAL).then(p=>{if(null!=p)return s(p);{let h=250;return this.systemService.setConfigValue(d.c.DAILY_CARB_GOAL,h),s(h)}})})}setDailyCarbGoal(s){this.systemService.setConfigValue(d.c.DAILY_CARB_GOAL,s)}}return(l=M).\u0275fac=function(s){return new(s||l)(u.KVO(g.BP),u.KVO(m.U),u.KVO(d.V))},l.\u0275prov=u.jDH({token:l,factory:l.\u0275fac,providedIn:"root"}),M})()}}]);