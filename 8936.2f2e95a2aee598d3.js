"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8936],{8385:(R,E,o)=>{o.d(E,{g:()=>C});var t=o(4438),f=o(3819);function i(e,v){if(1&e&&(t.j41(0,"p")(1,"b"),t.EFF(2),t.k0s()()),2&e){const m=t.XpG();t.R7$(2),t.SpI("",m.selectedItems.length," items selected")}}function M(e,v){if(1&e&&(t.j41(0,"p")(1,"b"),t.EFF(2),t.k0s()()),2&e){const m=t.XpG();t.R7$(2),t.SpI("",m.selectedPortions.length," portions selected")}}let C=(()=>{var e;class v{constructor(d){this.modalController=d,this.title="Catalog",this.canAddItems=!1,this.canSelectItems=!1,this.canSelectPortions=!1,this.returnData={},this.selectedItems=[],this.selectedPortions=[]}ngOnInit(){}dismiss(){return this.modalController.dismiss(this.constructReturnData("dismiss"))}confirm(){return this.modalController.dismiss(this.constructReturnData("confirmSelection"))}itemSelected(d){-1==this.selectedItems.indexOf(d)&&this.selectedItems.push(d)}portionSelected(d){-1==this.selectedPortions.indexOf(d)&&this.selectedPortions.push(d)}constructReturnData(d){let r={...this.returnData};return r.returnedItems=this.selectedItems,r.returnedPortions=this.selectedPortions,r}}return(e=v).\u0275fac=function(d){return new(d||e)(t.rXU(f.W3))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-food-catalog-modal"]],decls:23,vars:9,consts:[["catalog",""],["slot","end"],["color","medium",3,"click"],["name","close"],[3,"translucent"],["headerMode","none",3,"segmentChanged"],[3,"fullscreen"],[3,"onItemSelected","onPortionSelected","onSelectionComplete","canAddItems","canSelectPortions","canSelectItems"],[3,"searchTermChanged"],[4,"ngIf"],["color","success","fill","outline",3,"click","strong"]],template:function(d,r){if(1&d){const l=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3),t.k0s(),t.j41(4,"ion-buttons",1)(5,"ion-button",2),t.bIt("click",function(){return t.eBV(l),t.Njj(r.dismiss())}),t.nrm(6,"ion-icon",3),t.k0s()()()(),t.j41(7,"ion-header",4)(8,"app-food-catalog-header",5),t.bIt("segmentChanged",function(n){t.eBV(l);const a=t.sdS(11);return t.Njj(a.handleSegmentChanged(n))}),t.k0s()(),t.j41(9,"ion-content",6)(10,"app-food-catalog",7,0),t.bIt("onItemSelected",function(n){return t.eBV(l),t.Njj(r.itemSelected(n))})("onPortionSelected",function(n){return t.eBV(l),t.Njj(r.portionSelected(n))})("onSelectionComplete",function(){return t.eBV(l),t.Njj(r.confirm())}),t.k0s()(),t.j41(12,"ion-footer")(13,"app-food-catalog-footer",8),t.bIt("searchTermChanged",function(n){t.eBV(l);const a=t.sdS(11);return t.Njj(a.handleSearchTermChanged(n))}),t.k0s()(),t.j41(14,"ion-footer")(15,"ion-toolbar"),t.DNE(16,i,3,1,"p",9)(17,M,3,1,"p",9),t.j41(18,"ion-buttons",1)(19,"ion-button",2),t.bIt("click",function(){return t.eBV(l),t.Njj(r.dismiss())}),t.EFF(20," Cancel "),t.k0s(),t.j41(21,"ion-button",10),t.bIt("click",function(){return t.eBV(l),t.Njj(r.confirm())}),t.EFF(22,"Confirm"),t.k0s()()()()}2&d&&(t.R7$(3),t.JRh(r.title),t.R7$(4),t.Y8G("translucent",!0),t.R7$(2),t.Y8G("fullscreen",!0),t.R7$(),t.Y8G("canAddItems",r.canAddItems)("canSelectPortions",r.canSelectPortions)("canSelectItems",r.canSelectItems),t.R7$(6),t.Y8G("ngIf",r.canSelectItems),t.R7$(),t.Y8G("ngIf",r.canSelectPortions),t.R7$(4),t.Y8G("strong",!0))}}),v})()},4569:(R,E,o)=>{o.d(E,{H:()=>d});var t=o(467),f=o(8581),i=o(9195),M=o(9275),C=o(8385),e=o(4438),v=o(3819),m=o(2038);let d=(()=>{var r;class l extends M.y{constructor(n,a,h){super(a,h),this.modalController=n,this.databaseService=a,this.loadingService=h}deleteDefaultData(){var n=this;let a=i.g.catalogItems;return new Promise(h=>{let _=0;a.forEach(function(){var P=(0,t.A)(function*(D){if(yield n.deleteEntityFromDB(D.id),_++,_>=a.length)return h()});return function(D){return P.apply(this,arguments)}}())})}setupTableData(){this.tableName=f.jj.CATALOG_ITEM}setupDefaultData(n){var a=this;return(0,t.A)(function*(){let h;a.databaseService.getDatabase().then(_=>(h=_,h.count(f.jj.CATALOG_ITEM))).then(_=>{_<=0||n?i.g.catalogItems.forEach(function(){var P=(0,t.A)(function*(D){yield a.createEntityInDB(h,D),i.g.catalogItems.indexOf(D)>=i.g.catalogItems.length-1&&(a.reserveDatabaseEntries(),a.dataReady.next(!0))});return function(D){return P.apply(this,arguments)}}()):(a.reserveDatabaseEntries(),a.dataReady.next(!0))})})()}openFoodCatalog(n){this.modalController.create({component:C.g,showBackdrop:!0,backdropDismiss:!1,canDismiss:(a,h)=>new Promise(_=>{n.callback&&n.callback(a),this.handleModalClosed(a),_(!0)}),componentProps:{title:n.title,canSelectItems:n.canSelectItems,canSelectPortions:n.canSelectPortions,canAddItems:n.canAddItems}}).then(a=>{a.present()})}handleModalClosed(n){}}return(r=l).\u0275fac=function(n){return new(n||r)(e.KVO(v.W3),e.KVO(f.BP),e.KVO(m.U))},r.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"}),l})()},5293:(R,E,o)=>{o.d(E,{t:()=>v});var t=o(467),f=o(8581),i=o(9195),M=o(9275),C=o(4438),e=o(2038);let v=(()=>{var m;class d extends M.y{constructor(l,s){super(l,s),this.databaseService=l,this.loadingService=s}deleteDefaultData(){var l=this;let s=i.g.portions;return new Promise(n=>{let a=0;s.forEach(function(){var h=(0,t.A)(function*(_){if(yield l.deleteEntityFromDB(_.id),a++,a>=s.length)return n()});return function(_){return h.apply(this,arguments)}}())})}setupTableData(){this.tableName=f.jj.PORTION}setupDefaultData(l){var s=this;return(0,t.A)(function*(){var n;let a,h=null!==(n=s.tableName)&&void 0!==n?n:"ERROR",_=i.g.portions;s.databaseService.getDatabase().then(P=>(a=P,a.count(h))).then(P=>{P<=0||l?_.forEach(function(){var D=(0,t.A)(function*(F){yield s.createEntityInDB(a,F),_.indexOf(F)>=_.length-1&&(s.reserveDatabaseEntries(),s.dataReady.next(!0))});return function(F){return D.apply(this,arguments)}}()):(s.reserveDatabaseEntries(),s.dataReady.next(!0))})})()}}return(m=d).\u0275fac=function(l){return new(l||m)(C.KVO(f.BP),C.KVO(e.U))},m.\u0275prov=C.jDH({token:m,factory:m.\u0275fac,providedIn:"root"}),d})()},8936:(R,E,o)=>{o.r(E),o.d(E,{SettingsPageModule:()=>j});var t=o(177),f=o(4341),i=o(3819),M=o(9858),C=o(7144),e=o(4438),v=o(1799),m=o(529),d=o(8581),r=o(4988),l=o(2038),s=o(4569),n=o(5293),a=o(7225),h=o(8317),_=o(4075),P=o(345);const F=[{path:"",component:(()=>{var g;class b{constructor(c,u,S,p,y,O,B,U,A,G,k){this.systemService=c,this.messageService=u,this.databaseService=S,this.alertService=p,this.loadingService=y,this.catalogService=O,this.portionService=B,this.foodLogService=U,this.imageCaptureService=A,this.imageService=G,this._sanitizer=k,this.properties={appVersion:C.c.version,dbVersion:C.c.dbVersion},this.settings={carbGoal:0},this.imagePath=""}ngOnInit(){this.setup()}setup(){this.getCarbGoal()}toggleChange(c){this.systemService.toggleChange(c),this.messageService.display("Dark mode changed",3,"middle")}deleteDefaultData(){this.alertService.promptConfirmation("Confirm","are you sure you want to delete built-in app data?","no","yes").then(c=>{c&&this.databaseService.triggerDeleteDefaultData()})}restoreDefaultData(){this.alertService.promptConfirmation("Confirm","are you sure you want to restore default data back to initial app state?","no","yes").then(c=>{c&&this.databaseService.triggerRestoreDefaultData()})}getCarbGoal(){this.loadingService.addToQueue(this.foodLogService.getDailyCarbGoal().then(c=>{this.settings.carbGoal=c}))}setCarbGoal(){null!=this.settings.carbGoal&&this.settings.carbGoal>0&&this.foodLogService.setDailyCarbGoal(this.settings.carbGoal)}takePhoto(){this.imageCaptureService.requestPhoto().then(c=>{c?(console.log(c),this.imageCaptureService.readFileFromPath(c.filepath).then(u=>{console.log(u),this.imagePath=`data:image/jpeg;base64,${u.data}`})):this.alertService.simpleError("Error during image upload")})}}return(g=b).\u0275fac=function(c){return new(c||g)(e.rXU(v.V),e.rXU(m.b),e.rXU(d.BP),e.rXU(r.u),e.rXU(l.U),e.rXU(s.H),e.rXU(n.t),e.rXU(a.i),e.rXU(h.X),e.rXU(_.f),e.rXU(P.up))},g.\u0275cmp=e.VBU({type:g,selectors:[["app-settings"]],decls:45,vars:10,consts:[[3,"translucent"],["slot","start"],["size","large"],[3,"fullscreen"],[3,"inset"],["justify","space-between",3,"ngModelChange","ionChange","ngModel"],["color","danger",3,"click"],["slot","icon-only","name","trash"],["color","warning",3,"click"],["slot","icon-only","name","refresh"],["label","Daily carb goal","labelPlacement","stacked","helperText","Roughly 1/8th of your daily calorie goal","type","number",3,"ngModelChange","ionChange","ngModel"],[3,"click"],[3,"src"]],template:function(c,u){1&c&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e.nrm(3,"ion-menu-button"),e.k0s(),e.j41(4,"ion-title",2),e.EFF(5,"Settings"),e.k0s()()(),e.j41(6,"ion-content",3)(7,"ion-list-header"),e.EFF(8,"Appearance"),e.k0s(),e.j41(9,"ion-list",4)(10,"ion-item")(11,"ion-toggle",5),e.mxI("ngModelChange",function(p){return e.DH7(u.systemService.darkModeToggle,p)||(u.systemService.darkModeToggle=p),p}),e.bIt("ionChange",function(p){return u.toggleChange(p)}),e.EFF(12,"Dark Mode"),e.k0s()()(),e.j41(13,"ion-list-header"),e.EFF(14,"Data"),e.k0s(),e.j41(15,"ion-list",4)(16,"ion-item")(17,"ion-label"),e.EFF(18," Delete default data "),e.j41(19,"p"),e.EFF(20,"deletes built-in data from app (including changes you have made)"),e.k0s()(),e.j41(21,"ion-button",6),e.bIt("click",function(){return u.deleteDefaultData()}),e.nrm(22,"ion-icon",7),e.k0s()(),e.j41(23,"ion-item")(24,"ion-label"),e.EFF(25," Restore default data "),e.j41(26,"p"),e.EFF(27,"restores built-in data to original app state"),e.k0s()(),e.j41(28,"ion-button",8),e.bIt("click",function(){return u.restoreDefaultData()}),e.nrm(29,"ion-icon",9),e.k0s()()(),e.j41(30,"ion-list-header"),e.EFF(31,"Personal"),e.k0s(),e.j41(32,"ion-list",4)(33,"ion-item")(34,"ion-input",10),e.mxI("ngModelChange",function(p){return e.DH7(u.settings.carbGoal,p)||(u.settings.carbGoal=p),p}),e.bIt("ionChange",function(){return u.setCarbGoal()}),e.k0s()()(),e.j41(35,"ion-button",11),e.bIt("click",function(){return u.takePhoto()}),e.EFF(36,"Take photo"),e.k0s(),e.nrm(37,"img",12),e.k0s(),e.j41(38,"ion-footer")(39,"ion-toolbar")(40,"ion-note"),e.EFF(41),e.k0s(),e.nrm(42,"br"),e.j41(43,"ion-note"),e.EFF(44),e.k0s()()()),2&c&&(e.Y8G("translucent",!0),e.R7$(6),e.Y8G("fullscreen",!0),e.R7$(3),e.Y8G("inset",!0),e.R7$(2),e.R50("ngModel",u.systemService.darkModeToggle),e.R7$(4),e.Y8G("inset",!0),e.R7$(17),e.Y8G("inset",!0),e.R7$(2),e.R50("ngModel",u.settings.carbGoal),e.R7$(3),e.Y8G("src",u.imagePath,e.B4B),e.R7$(4),e.SpI("app v",u.properties.appVersion,""),e.R7$(3),e.SpI("db v",u.properties.dbVersion,""))},dependencies:[f.BC,f.vS,i.Jm,i.QW,i.W9,i.M0,i.eU,i.iq,i.$w,i.uz,i.he,i.nf,i.AF,i.MC,i.JI,i.BC,i.BY,i.ai,i.hB,i.su]}),b})()}];let T=(()=>{var g;class b{}return(g=b).\u0275fac=function(c){return new(c||g)},g.\u0275mod=e.$C({type:g}),g.\u0275inj=e.G2t({imports:[M.iI.forChild(F),M.iI]}),b})(),j=(()=>{var g;class b{}return(g=b).\u0275fac=function(c){return new(c||g)},g.\u0275mod=e.$C({type:g}),g.\u0275inj=e.G2t({imports:[t.MD,f.YN,i.bv,T]}),b})()}}]);